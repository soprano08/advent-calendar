<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Koło Fortuny</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 40px;
    }

    #wheel {
        width: 400px;
        height: 400px;
        border-radius: 50%;
        border: 8px solid #333;
        margin: 0 auto;
        position: relative;
        overflow: hidden;
        transform: rotate(0deg);
        transition: transform 4s cubic-bezier(.17,.67,.12,1);
    }

    .slice {
        position: absolute;
        width: 50%;
        height: 50%;
        top: 50%;
        left: 50%;
        transform-origin: 0% 0%;
        border: 1px solid #ccc;
    }

    #arrow {
        width: 0;
        height: 0;
        margin: 0 auto 20px;
        border-left: 20px solid transparent;
        border-right: 20px solid transparent;
        border-top: 35px solid red; /* strzałka w dół */
    }

    #spinBtn {
        padding: 10px 20px;
        font-size: 18px;
        cursor: pointer;
    }

    .legend {
        margin-top: 30px;
        text-align: left;
        width: 300px;
        margin-left: auto;
        margin-right: auto;
    }
</style>
</head>
<body>

<div id="arrow"></div>
<div id="wheel"></div>
<button id="spinBtn">Zakręć</button>

<div class="legend">
    <h3>Legenda:</h3>
    <p>1: Nagroda 1</p>
    <p>2: Nagroda 2</p>
    <p>3: Nagroda 3</p>
    <p>4: Nagroda 4</p>
    <p>5: Nagroda 5</p>
    <p>6: Nagroda 6</p>
    <p>7: Nagroda 7</p>
    <p>8: Nie do wylosowania</p>
</div>

<script>
const wheel = document.getElementById("wheel");
const btn = document.getElementById("spinBtn");

const numSlices = 8;
const angle = 360 / numSlices;

// Tworzenie segmentów koła z numerkami od 1 do 8
for (let i = 0; i < numSlices; i++) {
    const slice = document.createElement("div");
    slice.className = "slice";

    slice.style.transform = `rotate(${i * angle}deg) skewY(${90 - angle}deg)`;
    slice.style.background = `hsl(${i * 45}, 70%, 70%)`;

    // numer na każdym polu, wyliczony po środku segmentu
    const label = document.createElement("div");
    label.style.position = "absolute";
    label.style.fontSize = "24px";
    label.style.fontWeight = "bold";

    const rad = ((i * angle) + angle / 2) * (Math.PI / 180);
    const r = 120; // promień od środka koła do numerka
    label.style.left = `${50 + (r/200) * Math.cos(rad) * 50}%`;
    label.style.top = `${50 + (r/200) * Math.sin(rad) * 50}%`;
    label.style.transform = "translate(-50%, -50%)";

    label.textContent = i + 1;

    slice.appendChild(label);
    wheel.appendChild(slice);
}

let currentRotation = 0;

// Sprawdzenie localStorage, jeśli już wcześniej losowano
let savedResult = localStorage.getItem("wheelResultNumber");
if (savedResult) {
    btn.disabled = true;
    const sliceAngle = 360 / numSlices;
    const targetAngle = (savedResult - 1) * sliceAngle + (sliceAngle / 2);
    const extraTurns = 5 * 360;
    const finalRotation = extraTurns - targetAngle;
    wheel.style.transform = `rotate(${finalRotation}deg)`;
}

btn.onclick = function () {
    // WYKLUCZONE POLE 8 — NIE MOŻE BYĆ WYLOSOWANE
    const allowed = [1,2,3,4,5,6,7];
    const chosen = allowed[Math.floor(Math.random() * allowed.length)];

    const sliceAngle = 360 / numSlices;
    const targetAngle = (chosen - 1) * sliceAngle + (sliceAngle / 2);

    const extraTurns = 5 * 360;
    const finalRotation = extraTurns - targetAngle;

    currentRotation = finalRotation;
    wheel.style.transform = `rotate(${finalRotation}deg)`;

    // blokada przycisku i zapis wyniku
    btn.disabled = true;
    localStorage.setItem("wheelResultNumber", chosen);
};
</script>

</body>
</html>

