<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Koło fortuny</title>

<style>
body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 40px;
    padding: 20px;
    background: #eee;
}

#wheelContainer {
    position: relative;
    text-align: center;
}

#wheel {
    position: relative;
    width: 500px;
    height: 500px;
    border: 10px solid #333;
    border-radius: 50%;
    overflow: hidden;
}

.slice {
    position: absolute;
    width: 50%;
    height: 50%;
    top: 50%;
    left: 50%;
    transform-origin: 0% 0%;
    border-right: 2px solid white; /* biały pasek */
    background: red;
}

/* wskaźnik skierowany w dół */
#pointer {
    width: 0;
    height: 0;
    border-left: 25px solid transparent;
    border-right: 25px solid transparent;
    border-top: 40px solid black;
    margin: 0 auto 20px auto;
}

/* wyświetlanie wylosowanego koloru i nagrody */
#resultBox {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
}

#colorBox {
    width: 50px;
    height: 50px;
    border: 2px solid #333;
}

/* lista nagród obok koła */
#prizesList {
    text-align: left;
}
#prizesList ul {
    padding-left: 20px;
}

/* historia */
#history {
    margin-top: 20px;
    background: #fff;
    border: 1px solid #333;
    padding: 10px;
    width: 300px;
    max-height: 200px;
    overflow-y: auto;
}
</style>
</head>
<body>

<div id="wheelContainer">
    <div id="pointer"></div>
    <div id="wheel"></div>
    <button id="spinBtn">Zakręć</button>
    <div id="resultBox">
        <div id="colorBox"></div>
        <p id="result"></p>
    </div>
    <div id="history">
        <h3>Ostatnie losowania:</h3>
        <div id="historyList"></div>
    </div>
</div>

<div id="prizesList">
    <h3>Co do wygrania:</h3>
    <ul id="prizesUl"></ul>
</div>

<script>
let prizes = [
    "Dresy",
    "Gatki z niespodzianką",
    "Sesja buziakowa",
    "Filmik językowy",
    "Klata na życzenie",
    "Dłonie na życzenie",
    "Trochę głosówek",
    "Penis w całości"
];

let colors = Array(prizes.length).fill("red"); // całość czerwone

let wheel = document.getElementById("wheel");
let sliceCount = prizes.length;
let angleStep = 360 / sliceCount;

// tworzenie segmentów
for (let i = 0; i < sliceCount; i++) {
    let slice = document.createElement("div");
    slice.className = "slice";
    slice.style.transform = `rotate(${i * angleStep}deg) skewY(${90 - angleStep}deg)`;
    wheel.appendChild(slice);
}

// lista nagród obok koła
let prizesUl = document.getElementById("prizesUl");
prizes.forEach(p => {
    let li = document.createElement("li");
    li.textContent = p;
    prizesUl.appendChild(li);
});

// funkcja do aktualizacji historii
function updateHistory() {
    let history = JSON.parse(localStorage.getItem("wheelHistory") || "[]");
    let historyDiv = document.getElementById("historyList");
    historyDiv.innerHTML = history.slice(-10).map(h => `${h.time}: ${h.prize}`).join("<br>");
}
updateHistory();

// kręcenie kołem
document.getElementById("spinBtn").onclick = function() {
    let randomDeg = 3600 + Math.random() * 360;
    wheel.style.transition = "transform 4s ease-out";
    wheel.style.transform = `rotate(${randomDeg}deg)`;

    document.getElementById("result").innerHTML = "Losuję...";
    document.getElementById("colorBox").style.background = "white";

    setTimeout(() => {
        // kąt końcowy 0-360
        let finalDeg = randomDeg % 360;
        let index = sliceCount - 1 - Math.floor(finalDeg / angleStep);
        let selectedPrize = prizes[index];

        document.getElementById("result").innerHTML = selectedPrize;
        document.getElementById("colorBox").style.background = "red";

        // zapis historii
        let history = JSON.parse(localStorage.getItem("wheelHistory") || "[]");
        history.push({prize: selectedPrize, time: new Date().toLocaleString()});
        localStorage.setItem("wheelHistory", JSON.stringify(history));

        updateHistory();
    }, 4000);
};
</script>

</body>
</html>
